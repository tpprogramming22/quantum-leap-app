{"ast":null,"code":"import _objectSpread from\"/Users/ted/Downloads/Adminto_React_v1.1/adminto-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _createForOfIteratorHelper from\"/Users/ted/Downloads/Adminto_React_v1.1/adminto-react/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _createClass from\"/Users/ted/Downloads/Adminto_React_v1.1/adminto-react/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _classCallCheck from\"/Users/ted/Downloads/Adminto_React_v1.1/adminto-react/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import jwtDecode from'jwt-decode';import axios from'axios';import config from'../../config';// content type\naxios.defaults.headers.post['Content-Type']='application/json';axios.defaults.baseURL=config.API_URL;// intercepting to capture errors\naxios.interceptors.response.use(function(response){return response;},function(error){// Any status codes that falls outside the range of 2xx cause this function to trigger\nvar message;if(error&&error.response&&error.response.status===404){// window.location.href = '/not-found';\n}else if(error&&error.response&&error.response.status===403){window.location.href='/access-denied';}else{switch(error.response.status){case 401:message='Invalid credentials';break;case 403:message='Access Forbidden';break;case 404:message='Sorry! the data you are looking for could not be found';break;default:{message=error.response&&error.response.data?error.response.data['message']:error.message||error;}}return Promise.reject(message);}});var AUTH_SESSION_KEY='adminto_user';/**\n * Sets the default authorization\n * @param {*} token\n */var setAuthorization=function setAuthorization(token){if(token)axios.defaults.headers.common['Authorization']='JWT '+token;else delete axios.defaults.headers.common['Authorization'];};var getUserFromCookie=function getUserFromCookie(){var user=sessionStorage.getItem(AUTH_SESSION_KEY);return user?typeof user=='object'?user:JSON.parse(user):null;};var APICore=/*#__PURE__*/_createClass(function APICore(){var _this=this;_classCallCheck(this,APICore);this.get=function(url,params){var response;if(params){var queryString=params?Object.keys(params).map(function(key){return key+'='+params[key];}).join('&'):'';response=axios.get(\"\".concat(url,\"?\").concat(queryString),params);}else{response=axios.get(\"\".concat(url),params);}return response;};this.getFile=function(url,params){var response;if(params){var queryString=params?Object.keys(params).map(function(key){return key+'='+params[key];}).join('&'):'';response=axios.get(\"\".concat(url,\"?\").concat(queryString),{responseType:'blob'});}else{response=axios.get(\"\".concat(url),{responseType:'blob'});}return response;};this.getMultiple=function(urls,params){var reqs=[];var queryString='';if(params){queryString=params?Object.keys(params).map(function(key){return key+'='+params[key];}).join('&'):'';}var _iterator=_createForOfIteratorHelper(urls),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var url=_step.value;reqs.push(axios.get(\"\".concat(url,\"?\").concat(queryString)));}}catch(err){_iterator.e(err);}finally{_iterator.f();}return axios.all(reqs);};this.create=function(url,data){return axios.post(url,data);};this.updatePatch=function(url,data){return axios.patch(url,data);};this.update=function(url,data){return axios.put(url,data);};this.delete=function(url){return axios.delete(url);};this.createWithFile=function(url,data){var formData=new FormData();for(var k in data){formData.append(k,data[k]);}var config={headers:_objectSpread(_objectSpread({},axios.defaults.headers),{},{'content-type':'multipart/form-data'})};return axios.post(url,formData,config);};this.updateWithFile=function(url,data){var formData=new FormData();for(var k in data){formData.append(k,data[k]);}var config={headers:_objectSpread(_objectSpread({},axios.defaults.headers),{},{'content-type':'multipart/form-data'})};return axios.patch(url,formData,config);};this.isUserAuthenticated=function(){var user=_this.getLoggedInUser();if(!user){return false;}var decoded=jwtDecode(user.token);var currentTime=Date.now()/1000;if(decoded.exp<currentTime){console.warn('access token expired');return false;}else{return true;}};this.setLoggedInUser=function(session){if(session)sessionStorage.setItem(AUTH_SESSION_KEY,JSON.stringify(session));else{sessionStorage.removeItem(AUTH_SESSION_KEY);}};this.getLoggedInUser=function(){return getUserFromCookie();};this.setUserInSession=function(modifiedUser){var userInfo=sessionStorage.getItem(AUTH_SESSION_KEY);if(userInfo){var _JSON$parse=JSON.parse(userInfo),token=_JSON$parse.token,_user=_JSON$parse.user;_this.setLoggedInUser(_objectSpread(_objectSpread({token:token},_user),modifiedUser));}};});/*\nCheck if token available in session\n*/var user=getUserFromCookie();if(user){var token=user.token;if(token){setAuthorization(token);}}export{APICore,setAuthorization};","map":{"version":3,"sources":["/Users/ted/Downloads/Adminto_React_v1.1/adminto-react/src/helpers/api/apiCore.ts"],"names":["jwtDecode","axios","config","defaults","headers","post","baseURL","API_URL","interceptors","response","use","error","message","status","window","location","href","data","Promise","reject","AUTH_SESSION_KEY","setAuthorization","token","common","getUserFromCookie","user","sessionStorage","getItem","JSON","parse","APICore","get","url","params","queryString","Object","keys","map","key","join","getFile","responseType","getMultiple","urls","reqs","push","all","create","updatePatch","patch","update","put","delete","createWithFile","formData","FormData","k","append","updateWithFile","isUserAuthenticated","getLoggedInUser","decoded","currentTime","Date","now","exp","console","warn","setLoggedInUser","session","setItem","stringify","removeItem","setUserInSession","modifiedUser","userInfo"],"mappings":"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","sourcesContent":["import jwtDecode from 'jwt-decode';\nimport axios from 'axios';\n\nimport config from '../../config';\n\n// content type\naxios.defaults.headers.post['Content-Type'] = 'application/json';\naxios.defaults.baseURL = config.API_URL;\n\n// intercepting to capture errors\naxios.interceptors.response.use(\n    (response) => {\n        return response;\n    },\n    (error) => {\n        // Any status codes that falls outside the range of 2xx cause this function to trigger\n        let message;\n\n        if (error && error.response && error.response.status === 404) {\n            // window.location.href = '/not-found';\n        } else if (error && error.response && error.response.status === 403) {\n            window.location.href = '/access-denied';\n        } else {\n            switch (error.response.status) {\n                case 401:\n                    message = 'Invalid credentials';\n                    break;\n                case 403:\n                    message = 'Access Forbidden';\n                    break;\n                case 404:\n                    message = 'Sorry! the data you are looking for could not be found';\n                    break;\n                default: {\n                    message =\n                        error.response && error.response.data ? error.response.data['message'] : error.message || error;\n                }\n            }\n            return Promise.reject(message);\n        }\n    }\n);\n\nconst AUTH_SESSION_KEY = 'adminto_user';\n\n/**\n * Sets the default authorization\n * @param {*} token\n */\nconst setAuthorization = (token: string | null) => {\n    if (token) axios.defaults.headers.common['Authorization'] = 'JWT ' + token;\n    else delete axios.defaults.headers.common['Authorization'];\n};\n\nconst getUserFromCookie = () => {\n    const user = sessionStorage.getItem(AUTH_SESSION_KEY);\n    return user ? (typeof user == 'object' ? user : JSON.parse(user)) : null;\n};\nclass APICore {\n    /**\n     * Fetches data from given url\n     */\n    get = (url: string, params: any) => {\n        let response;\n        if (params) {\n            var queryString = params\n                ? Object.keys(params)\n                      .map((key) => key + '=' + params[key])\n                      .join('&')\n                : '';\n            response = axios.get(`${url}?${queryString}`, params);\n        } else {\n            response = axios.get(`${url}`, params);\n        }\n        return response;\n    };\n\n    getFile = (url: string, params: any) => {\n        let response;\n        if (params) {\n            var queryString = params\n                ? Object.keys(params)\n                      .map((key) => key + '=' + params[key])\n                      .join('&')\n                : '';\n            response = axios.get(`${url}?${queryString}`, { responseType: 'blob' });\n        } else {\n            response = axios.get(`${url}`, { responseType: 'blob' });\n        }\n        return response;\n    };\n\n    getMultiple = (urls: string, params: any) => {\n        const reqs = [];\n        let queryString = '';\n        if (params) {\n            queryString = params\n                ? Object.keys(params)\n                      .map((key) => key + '=' + params[key])\n                      .join('&')\n                : '';\n        }\n\n        for (const url of urls) {\n            reqs.push(axios.get(`${url}?${queryString}`));\n        }\n        return axios.all(reqs);\n    };\n\n    /**\n     * post given data to url\n     */\n    create = (url: string, data: any) => {\n        return axios.post(url, data);\n    };\n\n    /**\n     * Updates patch data\n     */\n    updatePatch = (url: string, data: any) => {\n        return axios.patch(url, data);\n    };\n\n    /**\n     * Updates data\n     */\n    update = (url: string, data: any) => {\n        return axios.put(url, data);\n    };\n\n    /**\n     * Deletes data\n     */\n    delete = (url: string) => {\n        return axios.delete(url);\n    };\n\n    /**\n     * post given data to url with file\n     */\n    createWithFile = (url: string, data: any) => {\n        const formData = new FormData();\n        for (const k in data) {\n            formData.append(k, data[k]);\n        }\n\n        const config: any = {\n            headers: {\n                ...axios.defaults.headers,\n                'content-type': 'multipart/form-data',\n            },\n        };\n        return axios.post(url, formData, config);\n    };\n\n    /**\n     * post given data to url with file\n     */\n    updateWithFile = (url: string, data: any) => {\n        const formData = new FormData();\n        for (const k in data) {\n            formData.append(k, data[k]);\n        }\n\n        const config: any = {\n            headers: {\n                ...axios.defaults.headers,\n                'content-type': 'multipart/form-data',\n            },\n        };\n        return axios.patch(url, formData, config);\n    };\n\n    isUserAuthenticated = () => {\n        const user = this.getLoggedInUser();\n\n        if (!user) {\n            return false;\n        }\n        const decoded: any = jwtDecode(user.token);\n        const currentTime = Date.now() / 1000;\n        if (decoded.exp < currentTime) {\n            console.warn('access token expired');\n            return false;\n        } else {\n            return true;\n        }\n    };\n\n    setLoggedInUser = (session: any) => {\n        if (session) sessionStorage.setItem(AUTH_SESSION_KEY, JSON.stringify(session));\n        else {\n            sessionStorage.removeItem(AUTH_SESSION_KEY);\n        }\n    };\n    /**\n     * Returns the logged in user\n     */\n    getLoggedInUser = () => {\n        return getUserFromCookie();\n    };\n\n    setUserInSession = (modifiedUser: any) => {\n        let userInfo = sessionStorage.getItem(AUTH_SESSION_KEY);\n        if (userInfo) {\n            const { token, user } = JSON.parse(userInfo);\n            this.setLoggedInUser({ token, ...user, ...modifiedUser });\n        }\n    };\n}\n\n/*\nCheck if token available in session\n*/\nlet user = getUserFromCookie();\nif (user) {\n    const { token } = user;\n    if (token) {\n        setAuthorization(token);\n    }\n}\n\nexport { APICore, setAuthorization };\n"]},"metadata":{},"sourceType":"module"}